<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute history of account activity status over time periods — accounts_by_status • mcrutils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute history of account activity status over time periods — accounts_by_status"><meta name="description" content="
This function categorizes accounts into different statuses (new, returning,
temporarily lost, regained, terminally lost and cumulative) based on their
order behavior in each time period. This is useful for
understanding customer retention and churn. Counts of accounts in each status
category can be included by setting with_counts = TRUE."><meta property="og:description" content="
This function categorizes accounts into different statuses (new, returning,
temporarily lost, regained, terminally lost and cumulative) based on their
order behavior in each time period. This is useful for
understanding customer retention and churn. Counts of accounts in each status
category can be included by setting with_counts = TRUE."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcrutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9005</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mcrutils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcaselli/mcrutils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute history of account activity status over time periods</h1>
      <small class="dont-index">Source: <a href="https://github.com/mcaselli/mcrutils/blob/master/R/accounts_by_status.R" class="external-link"><code>R/accounts_by_status.R</code></a></small>
      <div class="d-none name"><code>accounts_by_status.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This function categorizes accounts into different statuses (new, returning,
temporarily lost, regained, terminally lost and cumulative) based on their
order behavior in each time period. This is useful for
understanding customer retention and churn. Counts of accounts in each status
category can be included by setting <code>with_counts = TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">accounts_by_status</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">account_id</span>,</span>
<span>  <span class="va">order_date</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>  with_counts <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble of order information containing at least
account IDs and order dates</p></dd>


<dt id="arg-account-id-order-date">account_id, order_date<a class="anchor" aria-label="anchor" href="#arg-account-id-order-date"></a></dt>
<dd><p>&lt;<code><a href="https://dplyr.tidyverse.org/reference/dplyr_data_masking.html" class="external-link">data-masked</a></code>&gt;
columns in <code>data</code> corresponding to an account identifier and order dates,
erspectively</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>The time period resolution. Defaults to "month", but anything
supported as a <code>unit</code> argument for <a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">lubridate::floor_date</a> and <code>by</code> for
<a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a> is an option, e.g. "week", "quarter", "2 months" etc.</p></dd>


<dt id="arg-with-counts">with_counts<a class="anchor" aria-label="anchor" href="#arg-with-counts"></a></dt>
<dd><p>Logical, if TRUE, include counts of accounts in each
status category</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns for period start and end dates, lists of
account IDs in each status category, and optionally counts of accounts in
each category</p>
<p>The function returns a data frame with the following columns:</p><ul><li><p><code>period_start</code> (date): The start date of the period.</p></li>
<li><p><code>period_end</code> (date) : The end date of the period.</p></li>
<li><p><code>active</code> (list of character): Accounts with orders in the current
period.</p></li>
<li><p><code>new</code> (list of character): Accounts with their first-ever order in
the current period.</p></li>
<li><p><code>returning</code> (list of character): Accounts with orders in both the
current and prior periods.</p></li>
<li><p><code>temporarily_lost</code> (list of character): Accounts with orders in
the prior period but not in the current period, yet have orders in future
periods.</p></li>
<li><p><code>terminally_lost</code> (list of character): Accounts with orders in the
prior period but not in the current period, and no orders in future periods.</p></li>
<li><p><code>regained</code> (list of character): Accounts with orders in the current period, no orders in
the prior period, but had orders in earlier periods. i.e. an account that
comes back after being "temporarily lost"</p></li>
<li><p><code>cumulative</code> (list of character): All accounts that have ever had an order
up to and including the current period.</p></li>
</ul><p>if <code>with_counts</code> is TRUE, additional columns are included:</p><ul><li><p><code>n_active</code> (int): Count of active accounts in the current period.</p></li>
<li><p><code>n_new</code> (int): Count of new accounts in the current period.</p></li>
<li><p><code>n_returning</code> (int): Count of returning accounts in the current period.</p></li>
<li><p><code>n_temporarily_lost</code> (int): Count of temporarily lost accounts in the
current period.</p></li>
<li><p><code>n_terminally_lost</code> (int): Count of terminally lost accounts in the
current period.</p></li>
<li><p><code>n_regained</code> (int): Count of regained accounts in the current period.</p></li>
<li><p><code>n_cumulative</code> (int): Count of all accounts that have ever had an order
up to and including the current period.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">orders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> account_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> order_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">dates</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">orders</span> <span class="op">|&gt;</span> <span class="fu">accounts_by_status</span><span class="op">(</span><span class="va">account_id</span>, <span class="va">order_date</span>, with_counts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    period_start period_end              active     new returning regained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2022-01-01 2022-01-31             e, f, i e, f, i                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2022-02-01 2022-02-28                c, g    c, g                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    2022-03-01 2022-03-31 a, c, d, e, f, i, j a, d, j         c  e, f, i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    2022-04-01 2022-04-30             a, e, f           a, e, f         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2022-05-01 2022-05-31          a, d, f, h       h      a, f        d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    2022-06-01 2022-06-30          a, d, h, j           a, d, h        j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    2022-07-01 2022-07-31                   f                          f</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    2022-08-01 2022-08-31          d, f, h, j                 f  d, h, j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    2022-09-01 2022-09-30             d, e, j              d, j        e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   2022-10-01 2022-10-31          c, e, g, i                 e  c, g, i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   2022-11-01 2022-11-30             b, c, h       b         c        h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   2022-12-01 2022-12-31                b, f                 b        f</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    temporarily_lost terminally_lost                   cumulative n_active n_new</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                        e, f, i        3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           e, f, i                                e, f, i, c, g        2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 g                       e, f, i, c, g, a, d, j        7     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        c, d, i, j                       e, f, i, c, g, a, d, j        3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 e                    e, f, i, c, g, a, d, j, h        4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 f                    e, f, i, c, g, a, d, j, h        4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           d, h, j               a    e, f, i, c, g, a, d, j, h        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                      e, f, i, c, g, a, d, j, h        4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9              f, h                    e, f, i, c, g, a, d, j, h        3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10                             d, j    e, f, i, c, g, a, d, j, h        4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11                          e, g, i e, f, i, c, g, a, d, j, h, b        3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12                             c, h e, f, i, c, g, a, d, j, h, b        2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_returning n_regained n_temporarily_lost n_terminally_lost n_cumulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0          0                  0                 0            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0          0                  3                 0            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            1          3                  1                 0            8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            3          0                  4                 0            8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            2          1                  1                 0            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            3          1                  1                 0            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            0          1                  3                 1            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            1          3                  0                 0            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9            2          1                  2                 0            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           1          3                  0                 2            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           1          1                  0                 3           10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           1          1                  0                 2           10</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Caselli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

